[["sepia.html", "Chapter 6 Sepia 6.1 Getting Started 6.2 Data Cleaning 6.3 Plotting the Data 6.4 Creating a Subset 6.5 T-test", " Chapter 6 Sepia Date: 16/17 March 2022 (Animal Biodiversity course) Topic: Data manipulation, \\(t\\)-test Duration: 6090 minutes Does the common cuttlefish (Sepia officinalis) display sexual dimorphism? Are males perhaps taller or wider? In this chapter, you are going to scientifically compare two groups of measurements. 6.1 Getting Started The first step is to correctly read your data into the software: If you havent already, install RStudio; Download the data. If it is an Excel (.xlsx) file, open it in Excel and save as CSV; Open RStudio and create a new R markdown file. Save this file to the same folder as the data! Go to Session &gt; Set Working Directory &gt; To Source File Location. R now knows where to locate your data; Create a new code chunk and run the following: Sepia &lt;- read.csv(&quot;Sepia.csv&quot;) This requires that you named your data Sepia. From here on out, just read the text, run the code in R, adjust the R code if needed, and answer the questions. Note: For the sake of privacy, this page uses an old version of the data with scrambled names. I have also not linked the actual data. Please ask an assistant if you are unable to find it. The scrambled version can be downloaded here. If the code ran successfully, you will have an object called Sepia in your workspace. You can view it by clicking it, or by running: View(Sepia) Rather than type long names throughout the analysis, lets make the variable names a bit shorter: colnames(Sepia) &lt;- c(&quot;Name&quot;, &quot;Affix&quot;, &quot;Surname&quot;, &quot;TableNr&quot;, &quot;Group&quot;, &quot;Length&quot;, &quot;Width&quot;, &quot;Sex&quot;, &quot;Type&quot;) Does R understand which variables are numbers and which are something else? Lets check: str(Sepia) ## &#39;data.frame&#39;: 24 obs. of 9 variables: ## $ Name : chr &quot;nltCllt&quot; &quot;dilHH&quot; &quot;mEmE&quot; &quot;rrtM&quot; ... ## $ Affix : chr &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ... ## $ Surname: chr &quot;kakkBe&quot; &quot;zuoztHeta&quot; &quot;tronnC&quot; &quot;dnodrenaal&quot; ... ## $ TableNr: int 1 4 1 1 8 7 2 2 4 9 ... ## $ Group : int 1 1 1 1 1 1 1 1 1 1 ... ## $ Length : chr &quot;150&quot; &quot;78&quot; &quot;170&quot; &quot;93&quot; ... ## $ Width : chr &quot;56&quot; &quot;31&quot; &quot;64&quot; &quot;31&quot; ... ## $ Sex : chr &quot;man&quot; &quot;vrouwelijk&quot; &quot;vrouwelijk&quot; &quot;vrouwelijk&quot; ... ## $ Type : int 2 3 NA 3 NA 2 3 2 NA 3 ... Question: Is the data read correctly into R? How can you tell? What do you think chr and int mean? 6.2 Data Cleaning Even though length and width are numeric values, R says they are not. This is because there are some non-numeric values filled in in the fields for length and width. Lets fix that: Sepia$Length &lt;- as.numeric(Sepia$Length) Sepia$Width &lt;- as.numeric(Sepia$Width) This will produce a warning, informing you that some values have been overwritten. Those were actually the values that said geen schelp, so this is correct. There is another issue we have to fix: unique(Sepia$Sex) ## [1] &quot;man&quot; &quot;vrouwelijk&quot; &quot;mannelijk&quot; &quot;&quot; &quot;vrouwelijk &quot; ## [6] &quot;Mannelijk&quot; Students were not consistent with the use of wording. But your computer is not very smart, it expects VERY precise input. You could fix this manually, but here is a faster way: isMale &lt;- grepl(&quot;m&quot;, tolower(Sepia$Sex)) isFemale &lt;- grepl(&quot;v&quot;, tolower(Sepia$Sex)) Sepia$Sex &lt;- NA Sepia$Sex[isMale] &lt;- &quot;M&quot; Sepia$Sex[isFemale] &lt;- &quot;F&quot; unique(Sepia$Sex) ## [1] &quot;M&quot; &quot;F&quot; NA So why did that work? grepl searches for a pattern in a string. In the first line, I search for a lower-case m, because that only appears in the variations of the Dutch word for male. Some students may have used capital letters, so first I convert all strings to lower-case characters. In the second line, I use the same trick and search for v. In the third line, I overwrite all values with NA (not available). In the fourth line, I fill in a capital letter M where I know the observations are male. In the fifth line, I fill in a capital letter F where I know the observations are female. Other than that, you did a fairly good job. The only extra piece of data cleaning I can think of at this point is the observations with very large table numbers: sort(Sepia$TableNr) ## [1] 1 1 1 1 2 2 2 3 4 4 6 6 6 6 7 7 7 8 8 8 9 9 54 98 I dont think there are 98 tables in the practical room. You can overwrite a particular value like this: Sepia$TableNr[Sepia$TableNr == 98] &lt;- NA Do you know the right table number for this observation? Then you can replace NA by the number you think it should be. 6.3 Plotting the Data Just looking at code and numbers is a bit stale. So lets make some relevant plots: par(mfrow = c(2, 2)) # Plot in a 2x2 grid hist(Sepia$Length, col = &quot;lightgray&quot;) hist(Sepia$Width, col = &quot;lightgray&quot;) plot(Length ~ Width, data = Sepia, col = factor(Sex)) boxplot(Width ~ Sex, data = Sepia, col = c(&quot;blue&quot;, &quot;orange&quot;)) par(mfrow = c(1, 1)) # Restore the default Question: What does each plot show? There is at least one outlier in the data. Can you identify it from the plot? If you believe this value to be really this large, leave it as it (you can ask the students that measured it). If you dont trust this observation, you can set it to NA as shown above. Can you change the code to alter the figurees? (You can try changing the variable names, or change the graphical parameters.) 6.4 Creating a Subset We just read the whole data set. It contains the data from all groups Lets make a subset of the measurements performed by table 1, group 1: Subset &lt;- Sepia[Sepia$TableNr == 1 &amp; Sepia$Group == 1, ] What does this code do? Subset &lt;-: Create a variable named Subset; Sepia[x, y]: From the data set Sepia, select only rows x and columns y. If y is left blank, it selects all columns;1 Sepia$Groep == \"A\": From the data set Sepia, select the variable Group and check if it is equal to the value A (TRUE) or not (FALSE). Question: Adapt the code above to create a subset of measurements of the type of Sepia you measured (1, 2, or 3) and your group (1 or 2). 6.5 T-test How do we compare measurements of two groups? One way to do that is through a \\(t\\)-test. To choose the right \\(t\\)-test, you should understand five choices: Do you need a one-sample, or two-sample \\(t\\)-test? Do you want to test one-sided or two-sided? Is it reasonable to assume equal variance? Are the measurements independent or paired? Is the underlying assumption of normality reasonable? Do you remember all of those choices? Is so, impressive! If not, you can rewatch the video version of the lecture here: 6.5.1 Example Below is an example of a \\(t\\)-test, using some standard data in R: t.test(extra ~ group, data = sleep, alternative = &quot;less&quot;, var.equal = TRUE) ## ## Two Sample t-test ## ## data: extra by group ## t = -1.8608, df = 18, p-value = 0.03959 ## alternative hypothesis: true difference in means between group 1 and group 2 is less than 0 ## 95 percent confidence interval: ## -Inf -0.1076222 ## sample estimates: ## mean in group 1 mean in group 2 ## 0.75 2.33 This particular \\(t\\)-test is a one-sided \\(t\\)-test for equal variance. Heres how to interpret the output: The mean of group 1 is \\(0.75\\) hours of extra sleep, while the mean of group 2 is \\(2.33\\). The \\(p\\)-value for this test is \\(0.0396\\). If we use a level of significance of \\(\\alpha = 0.05\\), then group 2 is has a significantly larger mean than group 1, because \\(0.0396 &lt; 0.05\\). 6.5.2 Exercise Question: Choose a \\(t\\)-test you deem appropriate for: Comparing male and female length; Comparing male and female width. (They could be the same, just explain briefly why you chose a certain \\(t\\)-test.) Question: Perform the tests you chose for (1) and (2) in R and draw a conclusion. Have a look at how the example was coded using the data argument and adjust it to make it work for the data of your group (Subset). You may use the same level of significance \\(\\alpha = 0.05\\). Compare your results with at least one other group. If your conclusion differs, can you explain why? Did we now prove that Sepia males and females differ in physical dimensions? Did we prove they are the same? What is the right way to express the conclusion? (Optional) You performed two tests. That means that both can result in a false positive. With \\(\\alpha = 0.05\\), what is the chance of at least one false positive when performing two tests? "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
